<ion-list>

  <ion-list-header *ngIf="!searchOn">
    <h1>Nodes</h1>
    <span (click)="toggleSearch()">
      <ion-icon name="search"></ion-icon>
    </span>
  </ion-list-header>

  <ion-list-header class="searchContainer" *ngIf="searchOn">
    <ion-searchbar 
      color="secondary" 
      placeholder="Search Node.."
      [(ngModel)]="node"
      (ngModelChange)="filterNodes($event)"
    >
    </ion-searchbar>
    <span (click)="toggleSearch()">
      <ion-icon name="eye-off"></ion-icon>
    </span>
  </ion-list-header>
  
  <ion-item *ngIf="!nodesLoaded" text-center>
    <ion-label>
      <ion-spinner name="bubbles"></ion-spinner>
    </ion-label>
  </ion-item>

  <ion-virtual-scroll [items]="filteredNodes"  approxItemHeight="120px">
    <ion-item-sliding *virtualItem="let node">
      <ion-item *ngIf="nodesLoaded">
        <ion-avatar> 
          <!-- <ion-img [src]="node.imageUrl"></ion-img> -->
          <ion-img src="../assets/icon/favicon.png"></ion-img>
        </ion-avatar>
        <ion-label>
          <h4>{{ node.Nickname }}</h4>
          <p> 
            <ion-icon name="pin"></ion-icon> 
            {{ node.Location }}, Rank #{{ node.Rank }} <br> 
            Votes {{ getVotes(node.Votes) }} ({{ getVotePercent(node.Votes) }}%)
          <p>
        </ion-label>
        <ion-checkbox value="node" [(ngModel)]="node.isChecked"></ion-checkbox>
      </ion-item>
      <ion-item-options side="start">
        <ion-item-option 
          [routerLink]="[
            '/',
            node.Producer_public_key
          ]"
        >
          Node Details
        </ion-item-option>
      </ion-item-options>
    </ion-item-sliding>
  </ion-virtual-scroll>

</ion-list>

<br><br><br><br><br>

<ion-footer>
  <h5 class="footer1">
    Selected Nodes: <strong>{{ getSelectedNodes() }}</strong> 
  </h5>
  <ion-button class="footer2" (click)="castVote()">Cast Vote</ion-button>
</ion-footer>